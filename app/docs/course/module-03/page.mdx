# Оптические нейронные сети

## Архитектура D²NN

**Diffractive Deep Neural Network (D²NN)** — полностью оптическая нейросеть, использующая дифракцию света для вычислений.

### Структура

```
Вход → Слой 1 → Слой 2 → ... → Слой N → Детектор
       (DOE)     (DOE)          (DOE)
```

Каждый слой — дифракционный оптический элемент (DOE) с обучаемой фазовой маской.

### Математическое описание

Передача через слой $l$:

$$
U^{(l+1)}(x,y) = \mathcal{P}_z \left[ t^{(l)}(x,y) \cdot U^{(l)}(x,y) \right]
$$

где:
- $t^{(l)}(x,y) = e^{i\phi^{(l)}(x,y)}$ — комплексная передаточная функция
- $\mathcal{P}_z$ — оператор распространения на расстояние $z$
- $\phi^{(l)}(x,y)$ — обучаемая фазовая маска

## Обучение оптических систем

### Функция потерь

$$
\mathcal{L} = \frac{1}{N} \sum_{n=1}^{N} \text{CrossEntropy}(y_n, \hat{y}_n)
$$

где $\hat{y}_n$ — интенсивность на детекторе.

### Градиентный спуск

Обновление фазовой маски:

$$
\phi^{(l)} \leftarrow \phi^{(l)} - \eta \frac{\partial \mathcal{L}}{\partial \phi^{(l)}}
$$

Градиенты вычисляются через автоматическое дифференцирование.

## Пространственные модуляторы света

**SLM (Spatial Light Modulator)** — устройство для динамического управления фазой/амплитудой света.

### Типы SLM

| Тип | Модуляция | Разрешение | Скорость |
|-----|-----------|------------|----------|
| LC-SLM | Фаза | ~1000×1000 | ~60 Hz |
| DMD | Амплитуда | ~2000×1000 | ~20 kHz |
| LCOS | Фаза | ~4000×2000 | ~120 Hz |
